{% extends 'demo/base.html' %}
{% load static %}

{% block title %}用户登录{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/login.css' %}"/>
{% endblock %}

{% block content %}
<section class="auth-wrapper auth-wrapper--login">
    <div class="auth-grid">
        <div class="auth-card" id="loginFormContainer">
        <div class="auth-card__header">
            <h2>欢迎回来</h2>
            <p>登录您的 Django Hub 账户</p>
        </div>

        <div class="auth-card__highlight" aria-live="polite">
            <div class="auth-card__highlight-title">
                <i class="material-icons">lock</i>
                <span>演示账户</span>
            </div>
            <dl class="auth-card__highlight-meta">
                <div>
                    <dt>用户名</dt>
                    <dd>admin</dd>
                </div>
                <div>
                    <dt>密码</dt>
                    <dd>admin</dd>
                </div>
            </dl>
            <button type="button" class="auth-helper__button" id="fillDemoBtn">一键填充演示账户</button>
        </div>

        {% if messages %}
        <div class="auth-alert auth-alert--error" role="alert">
            <i class="material-icons" aria-hidden="true">error_outline</i>
            <div>
                {% for message in messages %}
                    <p>{{ message }}</p>
                {% endfor %}
            </div>
        </div>
        {% endif %}

        <form method="post" action="{% url 'demo:login' %}" id="loginForm" class="auth-form">
            {% csrf_token %}

            <div class="form-field">
                <input type="text" id="username" name="username" placeholder=" " required autocomplete="username">
                <label for="username">用户名</label>
                <small class="form-tip">请输入登录账号</small>
            </div>

            <div class="form-field">
                <input type="password" id="password" name="password" placeholder=" " required autocomplete="current-password">
                <label for="password">密码</label>
                <small class="form-tip">密码区分大小写</small>
            </div>

            <div class="form-extras">
                <label class="form-checkbox">
                    <input type="checkbox" id="rememberMe" name="remember_me">
                    <span class="form-checkbox__decor" aria-hidden="true">
                        <i class="material-icons">check</i>
                    </span>
                    <span class="form-checkbox__label">记住我</span>
                </label>
                <a class="form-link" href="mailto:admin@example.com">忘记密码？</a>
            </div>

            <button class="form-button" type="submit" id="loginSubmit">
                <span class="form-button__label">立即登录</span>
                <i class="material-icons" aria-hidden="true">arrow_forward</i>
            </button>
        </form>

        <div class="auth-footer">
            <span>还没有账号？</span>
            <a href="{% url 'demo:register' %}">立即注册</a>
        </div>
        </div>

        <div class="auth-hero">
            <div class="auth-hero__card">
                <div class="auth-hero__badge">Django Hub</div>
                <h1 class="auth-hero__title">集中化的团队权限管控中枢</h1>
                <p class="auth-hero__subtitle">随时掌握用户、用户组与关键操作动态，让协作始终安全高效。</p>
                <ul class="auth-hero__list">
                    <li><i class="material-icons">dashboard</i><span>统一的控制面板可视化用户状态</span></li>
                    <li><i class="material-icons">bolt</i><span>实时刷新与批量操作助力日常运维</span></li>
                    <li><i class="material-icons">security</i><span>精细化权限边界保障敏感数据安全</span></li>
                </ul>
            </div>
        </div>
    </div>
</section>

<script>
(function () {
    const form = document.getElementById('loginForm');
    const submitBtn = document.getElementById('loginSubmit');
    const usernameInput = document.getElementById('username');
    const passwordInput = document.getElementById('password');
    const demoBtn = document.getElementById('fillDemoBtn');

    if (form && submitBtn) {
        form.addEventListener('submit', function () {
            submitBtn.classList.add('is-loading');
            submitBtn.setAttribute('aria-busy', 'true');
            submitBtn.querySelector('.form-button__label').textContent = '登录中…';
        });
    }

    if (demoBtn && usernameInput && passwordInput) {
        demoBtn.addEventListener('click', function () {
            usernameInput.value = 'admin';
            passwordInput.value = 'admin';
            usernameInput.dispatchEvent(new Event('input'));
            passwordInput.dispatchEvent(new Event('input'));
            usernameInput.focus();
        });
    }
})();
</script>
{% endblock %}
